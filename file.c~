#include <stdio.h>
#include <dirent.h>
#include<string.h>
#include <sys/types.h> 
#include <sys/dir.h>

void listdir(char *path) 
{
	if(strcmp(path,".")==0)
	{
		chdir("..");
		return;
	}
	
	if(strcmp(path,"..")==0)
	{
		chdir("..");
		return;
	}
	
	//printf("\nIn listdir function %s",path);
		
	DIR *dirptr = opendir(path);
	if(dirptr==NULL)
	{
		//printf("\ndirptr is null");
		return;
	}
	printf("\n%s:",path);
	   struct dirent **namelist;
	   int n;

	   n = scandir(path, &namelist, NULL, alphasort);
	if (n < 0)
	{
		// printf("n is less then zero");
	}
	else 
	{	printf("\n");
		int m =n;
		while (m--) 
		{
			//Displaying
			char *name = namelist[m]->d_name;
		        if((strcmp(name,"..")!=0)&&(strcmp(name,".")!=0))			
			{
				//strcat(path,name);	
				printf("%s\t",name);
			}			
		}		
		while (n--) 
		{
			//Recursion logic
			//if(strcmp(namelist[n]->d_name,'.')!=0)
			char *name = namelist[n]->d_name;
		        //printf("Name of File parameter is: %s\n", name);
			chdir(path);	
						
			listdir(name);                   
			//free(namelist[n]);
		}
		//free(namelist);
	}

    
}

int main()
{
	char s[]="work";
	//chdir(s);
	listdir(s);
	return 0;
}

